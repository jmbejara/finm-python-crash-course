
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Homework 1: Numpy, Scipy, and Matplotlib &#8212; FINM August Review: Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=e1a75a79"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_notebook_build/_HW2--with-solutions';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="FINM August Review: Python - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="FINM August Review: Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    FINM August Review: Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Discussion 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discussion_01.html">1. Agenda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_setting_up_environment.html">1.1 Setting up your computing environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_methods_for_using_python.html">1.2 Ways to Interact with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_vscode_cursor.html">1.3 VS Code and Cursor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_environment_faq.html">1.4 Common Errors When Setting Up VS Code and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HW1.html">Homework 1: Introduction to VS Code and Git</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Discussion 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discussion_02.html">2. Agenda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syncing_files_with_git_and_github.html">2.1 Syncing Files with Git and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WRDS_intro_and_web_queries.html">2.2 Introduction to WRDS</a></li>
<li class="toctree-l1"><a class="reference internal" href="_02_01-Introducing-Pandas-Objects.html">2.3 Introducing Pandas Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="_02_02-Data-Indexing-and-Selection.html">2.4 Data Indexing and Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="_02_03-Operations-in-Pandas.html">2.5 Operating on Data in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="_02_04-Missing-Values.html">2.6 Handling Missing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="_02_CRSP_market_index.html">2.7 CRSP Market Returns Indices</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Discussion 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discussion_03.html">3. Agenda</a></li>
<li class="toctree-l1"><a class="reference internal" href="_03_overview_of_pydata_stack.html">2.2 Overview of the PyData Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="_03_comparing_plotting_libraries.html">2.3 Comparing Plotting Libraries and Declarative Visualizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="_03_Using_Interact.html">2.4 Using Interact (Optional)</a></li>
<li class="toctree-l1"><a class="reference internal" href="_03_python_by_example.html">2.5 Python Basics: An Introductory Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="_HW2-numpy-scipy.html">Homework 2: Numpy, Scipy, and Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="_03_factor_analysis_demo.html">3.5 Factor Analysis on Financial and Economic Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HW3.html">Homework 3: Introduction to WRDS and CRSP</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Discussion 4Ô∏è</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discussion_04.html">4. Agenda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_CRSP_data.html">4.1 Using CRSP Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="_04_wrds_python_package.html">4.2 Connecting to the WRDS Platform With Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../myst_markdown_demos.html">MyST Markdown Demos üí°</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apidocs/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../apidocs/misc_tools/misc_tools.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">misc_tools</span></code></a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jmbejara/finm-python-crash-course" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jmbejara/finm-python-crash-course/issues/new?title=Issue%20on%20page%20%2F_notebook_build/_HW2--with-solutions.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/_notebook_build/_HW2--with-solutions.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Homework 1: Numpy, Scipy, and Matplotlib</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-necessary-modules">Import Necessary Modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q1-use-built-in-numpy-functions-to-do-the-following-tasks">Q1. Use built-in Numpy functions to do the following tasks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q2-numpy-functions-continued-2-points-each">Q2. Numpy functions continued‚Ä¶ (2 points each)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-integration-with-scipy-2-points">Q3. Integration with Scipy (2 points)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-array-indexing-with-an-image-4-points">Q4. Array Indexing with an Image (4 points)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-fitting-a-curve-to-data-2-points-for-each-part">Q5. Fitting a Curve to Data (2 points for each part)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q6-compressing-an-image-with-linear-algebra-2-points-for-each-part">Q6. Compressing an Image with Linear Algebra (2 points for each part)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="homework-1-numpy-scipy-and-matplotlib">
<h1>Homework 1: Numpy, Scipy, and Matplotlib<a class="headerlink" href="#homework-1-numpy-scipy-and-matplotlib" title="Link to this heading">#</a></h1>
<p><strong>Intructions</strong></p>
<p>In this problem set, we‚Äôll be learning the basics of Numpy, Scipy, and Matplotlib.</p>
<p>A blank code or markup cell will be left after each exercise for you to fill in with your solution.</p>
<p>I‚Äôve completed the first few exercises for you to show you how you should format your HW submission.</p>
<section id="import-necessary-modules">
<h2>Import Necessary Modules<a class="headerlink" href="#import-necessary-modules" title="Link to this heading">#</a></h2>
<p>You should always start you file with all of the <code class="docutils literal notranslate"><span class="pre">import</span></code> statements that you will be using for the file. This makes it easier to quickly check what modules each file depends on‚Äîall you have to do is look at the top of the file.</p>
<p>For this problem, import numpy, scipy, and the pyplot submodule from matplotlib.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Completed for you</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.integrate</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">misc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="q1-use-built-in-numpy-functions-to-do-the-following-tasks">
<h2>Q1. Use built-in Numpy functions to do the following tasks<a class="headerlink" href="#q1-use-built-in-numpy-functions-to-do-the-following-tasks" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Create a vector (numpy array) of size 10 that contains all zeros and print it. (Use np.zeros.)</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">arange</span></code> to create a vector of values from 5 to 24. Print it.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">arange</span></code> and Python ‚Äúslicing‚Äù to create a vector of values from 24, to 5. Print it.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">arange</span></code> and Python ‚Äúslicing‚Äù to create a vector consisting of all the even integers in the half-open interval <span class="math notranslate nohighlight">\([0,30)\)</span>.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">arange</span></code> and <code class="docutils literal notranslate"><span class="pre">reshape</span></code> to create a 3x3 numpy array containing the numbers 0 to 8.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Completed for you</span>

<span class="c1"># 1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1.&quot;</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

<span class="c1"># 2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>

<span class="c1"># 3</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3.&quot;</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># 4</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4.&quot;</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># 5</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2.
[ 5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
3.
[24 23 22 21 20 19 18 17 16 15 14 13 12 11 10  9  8  7  6  5]
4.
[ 0  2  4  6  8 10 12 14 16 18 20 22 24 26 28]
5.
[[0 1 2]
 [3 4 5]
 [6 7 8]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="q2-numpy-functions-continued-2-points-each">
<h2>Q2. Numpy functions continued‚Ä¶ (2 points each)<a class="headerlink" href="#q2-numpy-functions-continued-2-points-each" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">eye</span></code> to create a 5x5 identity matrix. Print it.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">random.random</span></code> to generate a 3x3x3 array of numbers randomly generated from a uniform distribution over the support interval <span class="math notranslate nohighlight">\([0,1)\)</span>. Print it.</p></li>
<li><p>Create a 10x10 array with similarly generated random values. Find and print the minimum and maximum values appearing in the matrix using <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code>.</p></li>
<li><p>Create a random vector of size 30. Find and print the mean value.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">zeros</span></code> and/or <code class="docutils literal notranslate"><span class="pre">ones</span></code> and slicing to create a 10x10 array with 1‚Äôs on the border and 0‚Äôs inside.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2.&quot;</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; 3.&quot;</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">Zmin</span><span class="p">,</span> <span class="n">Zmax</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">Z</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Zmin</span><span class="p">,</span> <span class="n">Zmax</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4.&quot;</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5.&quot;</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">Z</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.
2.
3.
4.
5.
1.
[[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0.]
 [0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 1.]]
2.
[[[0.83576421 0.17119693 0.38987873]
  [0.35333896 0.31411774 0.85364812]
  [0.46525921 0.804961   0.39940244]]

 [[0.34139911 0.28739113 0.38512452]
  [0.75241562 0.19195341 0.6843169 ]
  [0.63010827 0.98581721 0.42073297]]

 [[0.79640296 0.65835498 0.49153288]
  [0.11942359 0.08548428 0.10387734]
  [0.81571587 0.86971657 0.03553895]]]
 3.
0.004204464127985252 0.9992454815692691
4.
0.5342216271254394
5.
[[1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="q3-integration-with-scipy-2-points">
<h2>Q3. Integration with Scipy (2 points)<a class="headerlink" href="#q3-integration-with-scipy-2-points" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>(1) The PDF of a Normal distibution is
$<span class="math notranslate nohighlight">\(
f(x; \mu, \sigma) =  \frac{1}{\sqrt{2 \pi \sigma^2}} \exp\left\{- \frac{(x - \mu)^2}{2 \sigma^2}\right\}
\)</span>$</p></li>
</ul>
<p>Let <span class="math notranslate nohighlight">\(\mu = 1\)</span> and <span class="math notranslate nohighlight">\(\sigma = 2\)</span>. Use Scipy to numerical integrate this function. Specifically, calculate
$<span class="math notranslate nohighlight">\(
 \int_{-2}^{2} f(x; \mu, \sigma) \mathrm d x
 \)</span>$</p>
<p>Verify your result using the built-in function for the CDF of a normal distribution: <code class="docutils literal notranslate"><span class="pre">scipy.stats.norm.cdf(x,</span> <span class="pre">loc=mu,</span> <span class="pre">scale=sigma)</span></code>. To calculate the proper area as the integral above, you will need to compute
$<span class="math notranslate nohighlight">\(
 F(2) - F(-2),
 \)</span><span class="math notranslate nohighlight">\(
 where \)</span>F$ is the CDF of the normal with mean 1 and standard deviation 2.</p>
<p>(Hint: You will need to import <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> and <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> to access the functions that you need.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.integrate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">integrand</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">integrand</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">res</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6246552600051551
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> 
 <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.624655260005155)
</pre></div>
</div>
</div>
</div>
</section>
<section id="q4-array-indexing-with-an-image-4-points">
<h2>Q4. Array Indexing with an Image (4 points)<a class="headerlink" href="#q4-array-indexing-with-an-image-4-points" title="Link to this heading">#</a></h2>
<p>Run the code in the cell below to access a matrix called <code class="docutils literal notranslate"><span class="pre">face</span></code>. Print the matrix to get an idea of what it looks like. What is its dimensions?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">misc</span>
<span class="n">face</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/l3/tj6vb0ld2ys1h939jz0qrfrh0000gn/T/ipykernel_70216/127514662.py:2: DeprecationWarning: scipy.misc.face has been deprecated in SciPy v1.10.0; and will be completely removed in SciPy v1.12.0. Dataset methods have moved into the scipy.datasets module. Use scipy.datasets.face instead.
  face = misc.face(gray=True).astype(&#39;float64&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">face</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[114., 130., 145., ..., 119., 129., 137.],
       [ 83., 104., 123., ..., 118., 134., 146.],
       [ 68.,  88., 109., ..., 119., 134., 145.],
       ...,
       [ 98., 103., 116., ..., 144., 143., 143.],
       [ 94., 104., 120., ..., 143., 142., 142.],
       [ 94., 106., 119., ..., 142., 141., 140.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">face</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(768, 1024)
</pre></div>
</div>
</div>
</div>
<p>Use the following code to plot the elements of the matrix as an image: <code class="docutils literal notranslate"><span class="pre">plt.imshow(face,</span> <span class="pre">cmap=plt.cm.gray)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x16feaba90&gt;
</pre></div>
</div>
<img alt="../_images/b8c7f1809eefb12bb79a4223c52378068e2c32ff63346b5df2bc37bdf7576324.png" src="../_images/b8c7f1809eefb12bb79a4223c52378068e2c32ff63346b5df2bc37bdf7576324.png" />
</div>
</div>
<p>Now, apply the function <code class="docutils literal notranslate"><span class="pre">np.sin(x/25)</span></code> to the face matrix and then plot it again. This doesn‚Äôt do anything very deep, it just messes with the shades of gray in a nonlinear way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">face</span><span class="o">/</span><span class="mi">25</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x17e26ffa0&gt;
</pre></div>
</div>
<img alt="../_images/3fea3c698fc648508e728507d90b35231f7ccc6eb29bba3e5a72f4b7a1f90ed5.png" src="../_images/3fea3c698fc648508e728507d90b35231f7ccc6eb29bba3e5a72f4b7a1f90ed5.png" />
</div>
</div>
<p>Imagine a circle with a center at the matrix indices (300, 620) and a radius of 250. In the x-y plane, this would be 620, 300. Write a snippet of code that, for each pixel, calculates the distance of that pixel from the center of this circle. If the distance is greater than the radius of the circle, set the value of the pixel (the element of the matrix) equal to zero. Plot the result, again using <code class="docutils literal notranslate"><span class="pre">plt.ishow</span></code> with a gray colormap.</p>
<p>Be sure to create a new copy of the <code class="docutils literal notranslate"><span class="pre">face</span></code> matrix, <code class="docutils literal notranslate"><span class="pre">face2</span></code>. Create a proper copy using the <code class="docutils literal notranslate"><span class="pre">copy</span></code> method of the <code class="docutils literal notranslate"><span class="pre">np.array</span></code> class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">face2</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="mi">620</span><span class="p">,</span> <span class="mi">300</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mi">250</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>        
        <span class="c1"># Your code here</span>
        <span class="k">pass</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x17e2e9990&gt;
</pre></div>
</div>
<img alt="../_images/b8c7f1809eefb12bb79a4223c52378068e2c32ff63346b5df2bc37bdf7576324.png" src="../_images/b8c7f1809eefb12bb79a4223c52378068e2c32ff63346b5df2bc37bdf7576324.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">face2</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="mi">620</span><span class="p">,</span> <span class="mi">300</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mi">250</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">distance_from_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">cx</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">cy</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">distance_from_center</span> <span class="o">&gt;</span> <span class="n">radius</span><span class="p">:</span>
            <span class="n">face2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x17f380520&gt;
</pre></div>
</div>
<img alt="../_images/4f498bd7a183fe2ad7bb35c3c4203943b99b4adcfe329a526a277c1538f7ba50.png" src="../_images/4f498bd7a183fe2ad7bb35c3c4203943b99b4adcfe329a526a277c1538f7ba50.png" />
</div>
</div>
</section>
<section id="q5-fitting-a-curve-to-data-2-points-for-each-part">
<h2>Q5. Fitting a Curve to Data (2 points for each part)<a class="headerlink" href="#q5-fitting-a-curve-to-data-2-points-for-each-part" title="Link to this heading">#</a></h2>
<p>In this exercise, you will fit a nonlinear curve to data by minimizing the sum of squares. Below, I have given data and a function to plot the data and a curve over the data. The curve is the following function:
$<span class="math notranslate nohighlight">\(
y(t) = x_0 \exp(-x_2 t) + x_1 \exp(-x_3 t).
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
  <span class="p">[[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">5.8955</span><span class="p">],</span> 
   <span class="p">[</span><span class="mf">0.1000</span><span class="p">,</span> <span class="mf">3.5639</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">0.2000</span><span class="p">,</span> <span class="mf">2.5173</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">0.3000</span><span class="p">,</span> <span class="mf">1.9790</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">0.4000</span><span class="p">,</span> <span class="mf">1.8990</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">0.5000</span><span class="p">,</span> <span class="mf">1.3938</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">0.6000</span><span class="p">,</span> <span class="mf">1.1359</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">0.7000</span><span class="p">,</span> <span class="mf">1.0096</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">0.8000</span><span class="p">,</span> <span class="mf">1.0343</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">0.9000</span><span class="p">,</span> <span class="mf">0.8435</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.6856</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">1.1000</span><span class="p">,</span> <span class="mf">0.6100</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">1.2000</span><span class="p">,</span> <span class="mf">0.5392</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">1.3000</span><span class="p">,</span> <span class="mf">0.3946</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">1.4000</span><span class="p">,</span> <span class="mf">0.3903</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">1.5000</span><span class="p">,</span> <span class="mf">0.5474</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">1.6000</span><span class="p">,</span> <span class="mf">0.3459</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">1.7000</span><span class="p">,</span> <span class="mf">0.1370</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">1.8000</span><span class="p">,</span> <span class="mf">0.2211</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">1.9000</span><span class="p">,</span> <span class="mf">0.1704</span><span class="p">],</span>
   <span class="p">[</span><span class="mf">2.0000</span><span class="p">,</span> <span class="mf">0.2636</span><span class="p">]])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_against_data</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">tgrid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ydata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">yfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">yfunc</span><span class="p">(</span><span class="n">tgrid</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tgrid</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tgrid</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
<span class="n">x_initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>(1): Use the given plotting function to plot the data and the curve for the given initial guess of the parameters, <code class="docutils literal notranslate"><span class="pre">x_initial</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_against_data</span><span class="p">(</span><span class="n">x_initial</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3558808ca1ff729ed00e4f6a666ae6ea8d1afb694c7bdd975dccce8300f46368.png" src="../_images/3558808ca1ff729ed00e4f6a666ae6ea8d1afb694c7bdd975dccce8300f46368.png" />
</div>
</div>
<ul class="simple">
<li><p>(2) Write a function called <code class="docutils literal notranslate"><span class="pre">sum_squares</span></code> that takes in a vector of model paraters (e.g., <code class="docutils literal notranslate"><span class="pre">x_initial</span></code>) and returns the sum of squares that results from the difference of the data and the curve defined by <code class="docutils literal notranslate"><span class="pre">x_initial</span></code>. What is the sum of squares that results from the given <code class="docutils literal notranslate"><span class="pre">x_initial</span></code>?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">sum_squares</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">tgrid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ydata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">yfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">yfunc</span><span class="p">(</span><span class="n">tgrid</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">ydata</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sum_squares</span><span class="p">(</span><span class="n">x_initial</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(27.432326688864467)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>(3) Use <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code> to minimize the sum of squares, using the function that you wrote previously. Save the optimal parameters to the variable <code class="docutils literal notranslate"><span class="pre">xstar</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">sum_squares</span><span class="p">,</span> <span class="n">x_initial</span><span class="p">)</span>
<span class="n">xstar</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
<span class="n">xstar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 3.00689943,  2.88903267, 10.58641815,  1.40031742])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>(4) Use the <code class="docutils literal notranslate"><span class="pre">plot_against_data</span></code> function that was given to plot the optimal curve, defined by <code class="docutils literal notranslate"><span class="pre">xstar</span></code>, against the data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_against_data</span><span class="p">(</span><span class="n">xstar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/87d3c17b3a31397a15560c4d48bffb202f7904cc127d05ff74ea3daaea11045a.png" src="../_images/87d3c17b3a31397a15560c4d48bffb202f7904cc127d05ff74ea3daaea11045a.png" />
</div>
</div>
</section>
<section id="q6-compressing-an-image-with-linear-algebra-2-points-for-each-part">
<h2>Q6. Compressing an Image with Linear Algebra (2 points for each part)<a class="headerlink" href="#q6-compressing-an-image-with-linear-algebra-2-points-for-each-part" title="Link to this heading">#</a></h2>
<p>Here we‚Äôll play with the Singular Value Decomposition (SVD) function in Numpy‚Äôs <code class="docutils literal notranslate"><span class="pre">linalg</span></code> submodule. You can think of the SVD as a generalization of the eigenvalue decomposition for non-square matrices.</p>
<p>Here we will be using the same <code class="docutils literal notranslate"><span class="pre">face</span></code> matrix as above.</p>
<ul>
<li><p>(1) To begin, calculate the SVD using the code. (For this part, you can just copy and paste this code.)</p>
<p><code class="docutils literal notranslate"><span class="pre">u,</span> <span class="pre">s,</span> <span class="pre">v</span> <span class="pre">=</span> <span class="pre">np.linalg.svd(face,</span> <span class="pre">full_matrices=False)</span></code></p>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>(2) Calculate the shape of <code class="docutils literal notranslate"><span class="pre">u</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code>, and <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(768, 768)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(768,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(768, 1024)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>(3) Construct a matrix by matrix multiplying <code class="docutils literal notranslate"><span class="pre">u</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code>, and <code class="docutils literal notranslate"><span class="pre">v</span></code>. Note that <code class="docutils literal notranslate"><span class="pre">s</span></code> doesn‚Äôt conform as it stands. Mathematically, we want to compute
$<span class="math notranslate nohighlight">\(
U \cdot \text{diag}(S) \cdot V.
\)</span><span class="math notranslate nohighlight">\(
Thus, we need \)</span>\text{diag}(S)$ to be a 768 x 768 matrix with the values of <code class="docutils literal notranslate"><span class="pre">s</span></code> on the diagonal. These are the singular values‚Äîanalogous to the eigenvalues‚Äîof the <code class="docutils literal notranslate"><span class="pre">face</span></code> matrix. Use <code class="docutils literal notranslate"><span class="pre">np.diag</span></code> to do this. Use <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> to perform the matrix multplication. Call this new matrix <code class="docutils literal notranslate"><span class="pre">faceUSV</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">faceUSV</span> <span class="o">=</span> <span class="n">u</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">@</span> <span class="n">v</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>(4) Use the function <code class="docutils literal notranslate"><span class="pre">np.allclose</span></code> to test if all of the elements of the matrices <code class="docutils literal notranslate"><span class="pre">faceUSV</span></code> and <code class="docutils literal notranslate"><span class="pre">face</span></code> are numerically close. Does this verify that our reconstruction was successful? Why are we using <code class="docutils literal notranslate"><span class="pre">np.allclose</span></code> instead of, say, <code class="docutils literal notranslate"><span class="pre">faceUSV</span> <span class="pre">==</span> <span class="pre">face</span></code> to test if the matrices are the same?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">faceUSV</span><span class="p">,</span> <span class="n">face</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># There are two reasons. Using `faceUSV == face` compares the individual elements and returns an array.</span>
<span class="c1"># If we wanted to return a single truth value, we would use `np.array.all`. </span>
<span class="c1"># The second reason is that `==` is too harsh, in a sense. Due to numerical error, these</span>
<span class="c1"># arrays may be slightly different. `np.allclose` tests if the are close within some small margin of error.</span>
<span class="c1"># Below is an example of what we would not want to do.</span>
<span class="p">(</span><span class="n">faceUSV</span> <span class="o">==</span> <span class="n">face</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.False_
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>(5) Now, construct a function called <code class="docutils literal notranslate"><span class="pre">compress</span></code> that takes in a number <code class="docutils literal notranslate"><span class="pre">n</span></code> and returns a matrix constructed as follows:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
U_n \cdot \text{diag}(S_n) \cdot V_n
\]</div>
<p>where <span class="math notranslate nohighlight">\(U_n\)</span> is only the first <code class="docutils literal notranslate"><span class="pre">n</span></code> columns of the matrix <code class="docutils literal notranslate"><span class="pre">u</span></code>, <span class="math notranslate nohighlight">\(\text{diag}(S_n)\)</span> is the first <code class="docutils literal notranslate"><span class="pre">n</span></code> singular values put on the diagonals of a matrix of zeros (hint: <code class="docutils literal notranslate"><span class="pre">np.diag(s[0:n])</span></code>), and <span class="math notranslate nohighlight">\(V_n\)</span> is the first <code class="docutils literal notranslate"><span class="pre">n</span></code> rows of the matrix <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compress</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">face_compressed</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">])</span> <span class="o">@</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">,:]</span>
    <span class="k">return</span> <span class="n">face_compressed</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>(6) Use your newly created <code class="docutils literal notranslate"><span class="pre">compress</span></code> function to create the a matrix called <code class="docutils literal notranslate"><span class="pre">face_compressed</span></code> for various values of <code class="docutils literal notranslate"><span class="pre">n</span></code>. Plot the matrix using <code class="docutils literal notranslate"><span class="pre">plt.imshow(face_compressed,</span> <span class="pre">cmap=plt.cm.gray)</span></code>. Do this for <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">in</span> <span class="pre">[500,</span> <span class="pre">300,</span> <span class="pre">100,</span> <span class="pre">50,</span> <span class="pre">10]</span></code>. What do you see happening?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">face_reduced</span> <span class="o">=</span> <span class="n">compress</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face_reduced</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x17f7d3c70&gt;
</pre></div>
</div>
<img alt="../_images/6950f2f51909da6605d35bc109c486ce504cb0e75f0678cc2ce60d490e24fa5f.png" src="../_images/6950f2f51909da6605d35bc109c486ce504cb0e75f0678cc2ce60d490e24fa5f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">face_reduced</span> <span class="o">=</span> <span class="n">compress</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face_reduced</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x30b028580&gt;
</pre></div>
</div>
<img alt="../_images/3ae9ddb32f6085a3479420d655e05477c88ae002daccfa2b4c6e17458d437ada.png" src="../_images/3ae9ddb32f6085a3479420d655e05477c88ae002daccfa2b4c6e17458d437ada.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">face_reduced</span> <span class="o">=</span> <span class="n">compress</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face_reduced</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x30b086860&gt;
</pre></div>
</div>
<img alt="../_images/d22d754fddb6a5eeff4387563ef5d0a1530876991eee51b0694d29144d96c2e8.png" src="../_images/d22d754fddb6a5eeff4387563ef5d0a1530876991eee51b0694d29144d96c2e8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">face_reduced</span> <span class="o">=</span> <span class="n">compress</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face_reduced</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x30cf1d480&gt;
</pre></div>
</div>
<img alt="../_images/c3f18e24d2b5045ee51b19c3dd2df417b5f394edee11aea9962367b76a61c058.png" src="../_images/c3f18e24d2b5045ee51b19c3dd2df417b5f394edee11aea9962367b76a61c058.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">face_reduced</span> <span class="o">=</span> <span class="n">compress</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face_reduced</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x30cf877c0&gt;
</pre></div>
</div>
<img alt="../_images/5f7809c52929e67b2cf99451d2e8b93ec749d394929aaa53f71d2213db23971e.png" src="../_images/5f7809c52929e67b2cf99451d2e8b93ec749d394929aaa53f71d2213db23971e.png" />
</div>
</div>
<ul class="simple">
<li><p>(7). Again use the <code class="docutils literal notranslate"><span class="pre">size</span></code> method to calculate the number of ‚Äúpixels‚Äù (elements in the array) that are in the original <code class="docutils literal notranslate"><span class="pre">face</span></code> matrix. Now, suppose we use the SVD to store this image. Write a function called <code class="docutils literal notranslate"><span class="pre">storage_size</span></code> that computes that number of elements in <span class="math notranslate nohighlight">\(U_r\)</span>, the number of elements in <span class="math notranslate nohighlight">\(V_r\)</span>, adds them together, and then adds <span class="math notranslate nohighlight">\(n\)</span> for the number of singular values of the <span class="math notranslate nohighlight">\(S_r\)</span> vector used. That is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
 storageSize = numberOfElements(U_n) + numberOfElements(V_n) + numberOfElements(S_n)
 \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">storage_size</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="n">n</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">,:]</span><span class="o">.</span><span class="n">size</span>
    <span class="c1"># Alternatively, u[:,0:n].size + s[0:n].size + v[0:n,:].size</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>(8) Compute the storage size for each of the values of <code class="docutils literal notranslate"><span class="pre">n</span></code> that we tested above. Compared to the original size, <code class="docutils literal notranslate"><span class="pre">face.size</span></code>,
how much space are we saving (in percentages) when we use <code class="docutils literal notranslate"><span class="pre">n=100</span></code> (which looks almost lossless)?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">face</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>786432
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_array</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n: &quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="n">storage_size</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n:  500
size 896500
n:  300
size 537900
n:  100
size 179300
n:  50
size 89650
n:  10
size 17930
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># We are saving approx. 77 percent!</span>
<span class="n">storage_size</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="n">face</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.22799173990885416
</pre></div>
</div>
</div>
</div>
<p><strong>NOTE:</strong> Essentially, we are reconstructing the matrix (and image) using the first <code class="docutils literal notranslate"><span class="pre">n</span></code> singular values. Equivalently, we could say that we are using Principal Component Analysis and reconstructing the image using the first <code class="docutils literal notranslate"><span class="pre">n</span></code> principal components. If this were a square matrix, we could say that we are using the first <code class="docutils literal notranslate"><span class="pre">n</span></code> eigenvalues and eigenvectors.</p>
<p>We will later see that this same technique can be used to analyze complex data. Imagine, for example, applying this procedure to a matrix of data or to the variance-covariance matrix of a set of variables. We will later see that, in the same way that we are compressing and summarizing a complex image, we can summarize the joint distribution of a set of variables.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-necessary-modules">Import Necessary Modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q1-use-built-in-numpy-functions-to-do-the-following-tasks">Q1. Use built-in Numpy functions to do the following tasks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q2-numpy-functions-continued-2-points-each">Q2. Numpy functions continued‚Ä¶ (2 points each)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-integration-with-scipy-2-points">Q3. Integration with Scipy (2 points)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-array-indexing-with-an-image-4-points">Q4. Array Indexing with an Image (4 points)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-fitting-a-curve-to-data-2-points-for-each-part">Q5. Fitting a Curve to Data (2 points for each part)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q6-compressing-an-image-with-linear-algebra-2-points-for-each-part">Q6. Compressing an Image with Linear Algebra (2 points for each part)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeremiah Bejarano
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024, Jeremiah Bejarano.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>